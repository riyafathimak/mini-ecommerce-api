<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Employee Management</title>
<link href="https://cdn.tailwindcss.com" rel="stylesheet">
</head>
<body class="bg-gray-100 p-6">

<h1 class="text-3xl font-bold mb-6 text-center">Employee Management</h1>
<button onclick="logout()" class="bg-red-500 text-white px-3 py-1 rounded absolute top-5 right-5">Logout</button>

<table class="w-full bg-white rounded shadow-md">
    <thead>
        <tr class="bg-gray-200"><th>ID</th><th>Name</th><th>Email</th><th>Role</th></tr>
    </thead>
    <tbody id="employeeTable"></tbody>
</table>

<script>
const EMP_API = "http://127.0.0.1:8000/api/employees/";
const TOKEN = localStorage.getItem("token");
if(!TOKEN) window.location.href = "/login/";

async function fetchEmployees() {
    const res = await fetch(EMP_API, { headers: {'Authorization': `Bearer ${TOKEN}`} });
    const data = await res.json();
    const tbody = document.getElementById("employeeTable");
    tbody.innerHTML = "";
    data.forEach(emp => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${emp.id}</td><td>${emp.username}</td><td>${emp.email}</td><td>${emp.is_admin ? 'Admin':'Employee'}</td>`;
        tbody.appendChild(tr);
    });
}

function logout() {
    localStorage.removeItem("token");
    window.location.href = "/login/";
}

fetchEmployees();
</script>

</body>
</html>
